---
controller_workflows:
  - name: "EDA for networks - interface status change"
    organization: "Default"
    state: "present"
    ask_variables_on_launch: "True"
    ask_limit_on_launch: true
    notification_templates_started:
      - "network-events slack channel"
    notification_templates_success:
      - "network-events slack channel"
    notification_templates_error:
      - "network-events slack channel"
    simplified_workflow_nodes:
      - identifier: "create incident"
        workflow_job_template: "EDA for networks - interface status change"
        unified_job_template: "EDA for networks - create incident"
        all_parents_must_converge: "False"
        success_nodes:
          - interface recovery
      - identifier: "interface recovery"
        workflow_job_template: "EDA for networks - interface status change"
        unified_job_template: "EDA for networks - interface recovery"
        all_parents_must_converge: "False"
        success_nodes:
          - update&close incident
        failure_nodes:
          - update incident
      - identifier: "update incident"
        workflow_job_template: "EDA for networks - interface status change"
        unified_job_template: "EDA for networks - update incident"
        all_parents_must_converge: "False"
      - identifier: "update&close incident"
        workflow_job_template: "EDA for networks - interface status change"
        unified_job_template: "EDA for networks - update and close incident"
        all_parents_must_converge: "False"

  - name: "EDA for networks - bgp network prefix configuration change"
    organization: "Default"
    state: "present"
    ask_variables_on_launch: "True"
    ask_limit_on_launch: true
    notification_templates_started:
      - "network-events slack channel"
    notification_templates_success:
      - "network-events slack channel"
    notification_templates_error:
      - "network-events slack channel"
    simplified_workflow_nodes:
      - identifier: "create incident"
        workflow_job_template: "EDA for networks - bgp network prefix configuration change"
        unified_job_template: "EDA for networks - create incident"
        all_parents_must_converge: "False"
        success_nodes:
          - enforce SoT config
      - identifier: "enforce SoT config"
        workflow_job_template: "EDA for networks - bgp network prefix configuration change"
        unified_job_template: "EDA for networks - enforce configuration from SoT"
        all_parents_must_converge: "False"
        success_nodes:
          - update&close incident
        failure_nodes:
          - update incident
      - identifier: "update&close incident"
        workflow_job_template: "EDA for networks - bgp network prefix configuration change"
        unified_job_template: "EDA for networks - update and close incident"
        all_parents_must_converge: "False"
      - identifier: "update incident"
        workflow_job_template: "EDA for networks - bgp network prefix configuration change"
        unified_job_template: "EDA for networks - update incident"
        all_parents_must_converge: "False"

  - name: "paloalto - provision fw configuration and security policies"
    organization: "Default"
    state: "present"
    inventory: paloalto inventory
    simplified_workflow_nodes:
      - identifier: "fw configuration"
        workflow_job_template: "paloalto - provision fw configuration and security policies"
        unified_job_template: "paloalto - configure fw"
        all_parents_must_converge: "False"
        success_nodes:
          - fw policies
      - identifier: "fw policies"
        workflow_job_template: "paloalto - provision fw configuration and security policies"
        unified_job_template: "paloalto - create security policies"
        all_parents_must_converge: "False"
        success_nodes:
          - commit configuration
      - identifier: "commit configuration"
        workflow_job_template: "paloalto - provision fw configuration and security policies"
        unified_job_template: "paloalto - commit configuration"
        all_parents_must_converge: "False"

  - name: "paloalto - deprovision fw configuration and security policies"
    organization: "Default"
    state: "present"
    inventory: paloalto inventory
    extra_vars:
      fw_config_state: absent
      fw_rules_state: absent
    simplified_workflow_nodes:
      - identifier: "remove fw policies"
        workflow_job_template: "paloalto - deprovision fw configuration and security policies"
        unified_job_template: "paloalto - create security policies"
        all_parents_must_converge: "False"
        success_nodes:
          - remove fw configuration
      - identifier: "remove fw configuration"
        workflow_job_template: "paloalto - deprovision fw configuration and security policies"
        unified_job_template: "paloalto - configure fw"
        all_parents_must_converge: "False"
        success_nodes:
          - commit configuration
      - identifier: "commit configuration"
        workflow_job_template: "paloalto - deprovision fw configuration and security policies"
        unified_job_template: "paloalto - commit configuration"
        all_parents_must_converge: "False"
